model1
plot(model1,1)
length(model1$residuals)
y <- Data$forest
# Take log for Agriculture Exports variable.
x1 <- log(Data$TX.VAL.AGRI.ZS.UN)
# Take log for GDP per Capita variable.
x2 <- log(Data$NY.GDP.PCAP.CD)
# Take log for Military Expenditure
x3 <- log(Data$MS.MIL.XPND.ZS)
# Make sure there aren't any -Inf after taking the log.
x1[which(x1==-Inf)] = NaN
x2[which(x2==-Inf)] = NaN
x3[which(x3==-Inf)] = NaN
model1 <- lm(forest~log(TX.VAL.AGRI.ZS.UN)+log(NY.GDP.PCAP.CD)+log(MS.MIL.XPND.ZS))
y <- Data$forest
# Take log for Agriculture Exports variable.
x1 <- log(Data$TX.VAL.AGRI.ZS.UN)
# Take log for GDP per Capita variable.
x2 <- log(Data$NY.GDP.PCAP.CD)
# Take log for Military Expenditure
x3 <- log(Data$MS.MIL.XPND.ZS)
# Make sure there aren't any -Inf after taking the log.
x1[which(x1==-Inf)] = NaN
x2[which(x2==-Inf)] = NaN
x3[which(x3==-Inf)] = NaN
model1 <- lm(forest~log(TX.VAL.AGRI.ZS.UN)+log(NY.GDP.PCAP.CD)+log(MS.MIL.XPND.ZS), data = Data)
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
y <- Data$forest
# Take log for Agriculture Exports variable.
x1 <- log(Data$TX.VAL.AGRI.ZS.UN)
# Take log for GDP per Capita variable.
x2 <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
x1[which(x1==-Inf)] = NaN
x2[which(x2==-Inf)] = NaN
model1 <- lm(forest~log(TX.VAL.AGRI.ZS.UN)+log(NY.GDP.PCAP.CD), data = Data)
model1
# Take log for Agriculture Exports variable.
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data$Log_Agri[which(x1==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data["Log_GDPperCap"] <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data$[which(x2==-Inf)] = NaN
# Take log for Agriculture Exports variable.
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data$Log_Agri[which(Data$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data["Log_GDPperCap"] <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data$Log_GDPperCap[which(Data$Log_GDPperCap==-Inf)] = NaN
model1 <- lm(forest~log(TX.VAL.AGRI.ZS.UN)+log(NY.GDP.PCAP.CD), data = Data)
model1
# Take log for Agriculture Exports variable.
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data$Log_Agri[which(Data$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data["Log_GDPperCap"] <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data$Log_GDPperCap[which(Data$Log_GDPperCap==-Inf)] = NaN
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data)
model1
# Take log for Agriculture Exports variable.
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data$Log_Agri[which(Data$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data["Log_GDPperCap"] <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data$Log_GDPperCap[which(Data$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data["Log_MilExp"] <- log(Data$MS.MIL.XPND.ZS)
# Make sure there aren't any -Inf after taking the log.
Data$Log_MilExp[which(Data$Log_MilExp==-Inf)] = NaN
model1 <- lm(forest~log_Agri+Log_GDPperCap+Log_MilExp, data = Data)
# Take log for Agriculture Exports variable.
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data$Log_Agri[which(Data$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data["Log_GDPperCap"] <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data$Log_GDPperCap[which(Data$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data["Log_MilExp"] <- log(Data$MS.MIL.XPND.ZS)
# Make sure there aren't any -Inf after taking the log.
Data$Log_MilExp[which(Data$Log_MilExp==-Inf)] = NaN
model1 <- lm(forest~Log_Agri+Log_GDPperCap+Log_MilExp, data = Data)
model1
model2 <- lm(Log_MilExp~Log_Agri+Log_GDPperCap, data = Data)$
r1 <- model2$residuals
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data)$
r1 <- model2$residuals
load("Week11.Rdata")
ls()
colnames(Data)[3] <- "forest"
# Take log for Agriculture Exports variable.
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data$Log_Agri[which(Data$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data["Log_GDPperCap"] <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data$Log_GDPperCap[which(Data$Log_GDPperCap==-Inf)] = NaN
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data)
model1
# Take log for Agriculture Exports variable.
Data["Log_Agri"] <- log(Data$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data$Log_Agri[which(Data$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data["Log_GDPperCap"] <- log(Data$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data$Log_GDPperCap[which(Data$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data["Log_MilExp"] <- log(Data$MS.MIL.XPND.ZS)
# Make sure there aren't any -Inf after taking the log.
Data$Log_MilExp[which(Data$Log_MilExp==-Inf)] = NaN
model1 <- lm(forest~Log_Agri+Log_GDPperCap+Log_MilExp, data = Data)
model1
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data)$
r1 <- model2$residuals
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data)
r1 <- model2$residuals
model3 <- lm(y~)
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data)
r1 <- model2$residuals
model3 <- lm(forest~lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data)$residuals, data = Data)
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data)
r1 <- model2$residuals
model3 <- lm(forest~model2$residuals, data = Data)
View(model1)
View(model2)
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data, na.action = na.pass)
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data)
model1
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
Data2 <- na.omit(Data2)
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data2)
model1
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
Data2 <- na.omit(Data2)
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data)
model1
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
Data2 <- na.omit(Data2)
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data2)
model1
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
#Data2 <- na.omit(Data2)
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data2)
model1
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
Data2 <- na.omit(Data2)
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data2)
model1
plot(model1,1)
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD,
"MS.MIL.XPND.ZS" = Data$MS.MIL.XPND.ZS)
# Take log for Agriculture Exports variable.
Data3["Log_Agri"] <- log(Data3$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Agri[which(Data3$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data3["Log_GDPperCap"] <- log(Data3$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_GDPperCap[which(Data3$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data3["Log_MilExp"] <- log(Data3$MS.MIL.XPND.ZS)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_MilExp[which(Data3$Log_MilExp==-Inf)] = NaN
model1 <- lm(forest~Log_Agri+Log_GDPperCap+Log_MilExp, data = Data)
model1
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD,
"MS.MIL.XPND.ZS" = Data$MS.MIL.XPND.ZS)
# Take log for Agriculture Exports variable.
Data3["Log_Agri"] <- log(Data3$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Agri[which(Data3$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data3["Log_GDPperCap"] <- log(Data3$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_GDPperCap[which(Data3$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data3["Log_MilExp"] <- log(Data3$MS.MIL.XPND.ZS)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_MilExp[which(Data3$Log_MilExp==-Inf)] = NaN
Data3 <- na.omit(Data3)
model1 <- lm(forest~Log_Agri+Log_GDPperCap+Log_MilExp, data = Data3)
model1
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data3)
r1 <- model2$residuals
model3 <-
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data3)
r1 <- model2$residuals
model3 <- lm(forest ~ r1, data = Data3)
model2 <- lm(Log_MilExp ~ Log_Agri + Log_GDPperCap, data = Data3)
r1 <- model2$residuals
model3 <- lm(forest ~ r1, data = Data3)
model3
plot(model2,1)
summary(model1)$r.square
summary(model2)$r.square
plot(model2,1)
summary(model1)$r.square
summary(model2)$r.square
plot(model2)
summary(model1)$r.square
summary(model2)$r.square
plot(model2,1)
summary(model1)$adjr.square
summary(model2)$adjr.square
plot(model2,1)
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2,1)
Mediland <- data.frame( "TX.VAL.AGRI.ZS.UN" = median(Data$TX.VAL.AGRI.ZS.UN),
"NY.GDP.PCAP.CD" = median(Data$NY.GDP.PCAP.CD),
"MS.MIL.XPND.ZS" = median(Data$MS.MIL.XPND.ZS))
View(Mediland)
(Data$TX.VAL.AGRI.ZS.UN
)
median(Data$TX.VAL.AGRI.ZS.UN)
Mediland <- data.frame( "TX.VAL.AGRI.ZS.UN" = median(Data$TX.VAL.AGRI.ZS.UN, na.rm = TRUE),
"NY.GDP.PCAP.CD" = median(Data$NY.GDP.PCAP.CD,  na.rm = TRUE),
"MS.MIL.XPND.ZS" = median(Data$MS.MIL.XPND.ZS,  na.rm = TRUE))
View(Mediland)
predict(model3 , data.frame(TX.VAL.AGRI.ZS.UN = Mediland$TX.VAL.AGRI.ZS.UN))
View(model3)
predict(model2 , data.frame(TX.VAL.AGRI.ZS.UN = Mediland$TX.VAL.AGRI.ZS.UN))
Mediland <- data.frame( "TX.VAL.AGRI.ZS.UN" = median(Data$TX.VAL.AGRI.ZS.UN, na.rm = TRUE),
"NY.GDP.PCAP.CD" = median(Data$NY.GDP.PCAP.CD,  na.rm = TRUE),
"MS.MIL.XPND.ZS" = median(Data$MS.MIL.XPND.ZS,  na.rm = TRUE))
Mediland["Log_Agri"] <- log(Mediland$TX.VAL.AGRI.ZS.UN)
Mediland["Log_GDPperCap"] <- log(Mediland$NY.GDP.PCAP.CD)
Mediland["Log_MilExp"] <- log(Mediland$MS.MIL.XPND.ZS)
predict(model2 , data.frame(log_Agri = Mediland$Log_Agri))
predict(model2 , data.frame(Log_Agri = Mediland$Log_Agri))
predict(model2 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap))
predict(model2 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_MilExp = Mediland$Log_MilExp))
predict(model2 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_MilExp = Mediland$Log_MilExp))
predict(model2 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_MilExp = Mediland$Log_MilExp))
median(Data$forest)
predict(model2 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_MilExp = Mediland$Log_MilExp))
median(Data$forest)
predict(model2 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_MilExp = Mediland$Log_MilExp))
median(Data$forest, na.rm = T)
View(model1)
predict(model1 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_MilExp = Mediland$Log_MilExp))
knitr::opts_chunk$set(echo = TRUE)
load("Week11.Rdata")
ls()
head(Definitions, 11)
hist(Data$AG.LND.FRST.ZS) # Maybe take sqrt
hist(Data$MS.MIL.MPRT.KD) # Log This
hist(Data$MS.MIL.XPND.GD.ZS) # Maybe take sqrt
hist(Data$MS.MIL.XPND.ZS) # Log This (Maybe sqrt)
hist(Data$MS.MIL.XPRT.KD) # Log This
hist(Data$NE.EXP.GNFS.CD) # Log This
hist(Data$NE.IMP.GNFS.CD) # Log This
hist(Data$NY.GDP.MKTP.CD) # Log This
hist(Data$NY.GDP.PCAP.CD) # Log This
hist(Data$NY.GDP.PETR.RT.ZS) # Log This (Maybe sqrt)
hist(Data$TX.VAL.AGRI.ZS.UN) # Log This (Maybe sqrt)
plot(log(Data$NE.IMP.GNFS.CD), log(Data$NE.EXP.GNFS.CD))
plot(log(Data$NY.GDP.MKTP.CD), log(Data$NE.EXP.GNFS.CD - Data$NE.IMP.GNFS.CD))
View(Data)
View(Definitions)
plot(Data$TX.VAL.AGRI.ZS.UN, Data$NE.EXP.GNFS.CD)
plot(log(Data$TX.VAL.AGRI.ZS.UN), log(Data$NE.EXP.GNFS.CD))
plot(log(Data$NE.IMP.GNFS.CD), log(Data$NE.EXP.GNFS.CD))
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD,
"NE.EXP.GNFS.CD" = Data$NE.EXP.GNFS.CD)
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD,
"NE.EXP.GNFS.CD" = Data$NE.EXP.GNFS.CD)
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
load("Week11.Rdata")
ls()
head(Definitions, 11)
hist(Data$AG.LND.FRST.ZS) # Maybe take sqrt
hist(Data$MS.MIL.MPRT.KD) # Log This
hist(Data$MS.MIL.XPND.GD.ZS) # Maybe take sqrt
hist(Data$MS.MIL.XPND.ZS) # Log This (Maybe sqrt)
hist(Data$MS.MIL.XPRT.KD) # Log This
hist(Data$NE.EXP.GNFS.CD) # Log This
hist(Data$NE.IMP.GNFS.CD) # Log This
hist(Data$NY.GDP.MKTP.CD) # Log This
hist(Data$NY.GDP.PCAP.CD) # Log This
hist(Data$NY.GDP.PETR.RT.ZS) # Log This (Maybe sqrt)
hist(Data$TX.VAL.AGRI.ZS.UN) # Log This (Maybe sqrt)
apply(!is.na(Data[-(1:2)]), MARGIN = 2, mean)
plot(log(Data$NE.IMP.GNFS.CD), log(Data$NE.EXP.GNFS.CD))
plot(log(Data$NY.GDP.MKTP.CD), log(Data$NE.EXP.GNFS.CD - Data$NE.IMP.GNFS.CD))
colnames(Data)[3] <- "forest"
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
Data2 <- na.omit(Data2)
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data2)
model1
plot(model1,1)
length(model1$residuals)
Countries <- Data$Country.Name
# Countries that have NaN for Agriculture Exports
Countries[is.na(Data$TX.VAL.AGRI.ZS.UN)]
# Countries that have NaN for GDP
Countries[is.na(Data$NY.GDP.PCAP.CD)]
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD,
"NE.EXP.GNFS.CD" = Data$NE.EXP.GNFS.CD)
# Take log for Agriculture Exports variable.
Data3["Log_Agri"] <- log(Data3$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Agri[which(Data3$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data3["Log_GDPperCap"] <- log(Data3$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_GDPperCap[which(Data3$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data3["Log_Export"] <- log(Data3$NE.EXP.GNFS.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Export[which(Data3$NE.EXP.GNFS.CD==-Inf)] = NaN
Data3 <- na.omit(Data3)
model1 <- lm(forest~Log_Agri+Log_GDPperCap+Log_Export, data = Data3)
model1
# Regress the third variable on your first two variables and extract the residuals.
model2 <- lm(Log_Export ~ Log_Agri + Log_GDPperCap, data = Data3)
r1 <- model2$residuals
# Regress forest on the residuals from the first stage.
model3 <- lm(forest ~ r1, data = Data3)
model3
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2,1)
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2)
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD,
"NE.EXP.GNFS.CD" = Data$NE.EXP.GNFS.CD)
# Take log for Agriculture Exports variable.
Data3["Log_Agri"] <- log(Data3$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Agri[which(Data3$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data3["Log_GDPperCap"] <- log(Data3$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_GDPperCap[which(Data3$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data3["Log_Export"] <- log(Data3$NE.EXP.GNFS.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Export[which(Data3$NE.EXP.GNFS.CD==-Inf)] = NaN
Data3 <- na.omit(Data3)
model2 <- lm(forest~Log_Agri+Log_GDPperCap+Log_Export, data = Data3)
model2
# Regress the third variable on your first two variables and extract the residuals.
model3 <- lm(Log_Export ~ Log_Agri + Log_GDPperCap, data = Data3)
r1 <- model3$residuals
# Regress forest on the residuals from the first stage.
model4 <- lm(forest ~ r1, data = Data3)
model4
Data2 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD)
# Take log for Agriculture Exports variable.
Data2["Log_Agri"] <- log(Data2$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_Agri[which(Data2$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data2["Log_GDPperCap"] <- log(Data2$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data2$Log_GDPperCap[which(Data2$Log_GDPperCap==-Inf)] = NaN
Data2 <- na.omit(Data2)
model1 <- lm(forest~Log_Agri+Log_GDPperCap, data = Data2)
model1
Data3 <- data.frame("forest" = Data$forest,
"TX.VAL.AGRI.ZS.UN" = Data$TX.VAL.AGRI.ZS.UN,
"NY.GDP.PCAP.CD" = Data$NY.GDP.PCAP.CD,
"NE.EXP.GNFS.CD" = Data$NE.EXP.GNFS.CD)
# Take log for Agriculture Exports variable.
Data3["Log_Agri"] <- log(Data3$TX.VAL.AGRI.ZS.UN)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Agri[which(Data3$Log_Agri==-Inf)] = NaN
# Take log for GDP per Capita variable.
Data3["Log_GDPperCap"] <- log(Data3$NY.GDP.PCAP.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_GDPperCap[which(Data3$Log_GDPperCap==-Inf)] = NaN
# Take log for Military Expenditure
Data3["Log_Export"] <- log(Data3$NE.EXP.GNFS.CD)
# Make sure there aren't any -Inf after taking the log.
Data3$Log_Export[which(Data3$NE.EXP.GNFS.CD==-Inf)] = NaN
Data3 <- na.omit(Data3)
model2 <- lm(forest~Log_Agri+Log_GDPperCap+Log_Export, data = Data3)
model2
# Regress the third variable on your first two variables and extract the residuals.
model3 <- lm(Log_Export ~ Log_Agri + Log_GDPperCap, data = Data3)
r1 <- model3$residuals
# Regress forest on the residuals from the first stage.
model4 <- lm(forest ~ r1, data = Data3)
model4
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2)
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2,1)
plot(model2,4)
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2,1)
plot(model2,3)
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2,1)
plot(model2,2)
summary(model1)$adj.r.square
summary(model2)$adj.r.square
plot(model2,1)
plot(model2,5)
Mediland <- data.frame( "TX.VAL.AGRI.ZS.UN" = median(Data$TX.VAL.AGRI.ZS.UN, na.rm = TRUE),
"NY.GDP.PCAP.CD" = median(Data$NY.GDP.PCAP.CD,  na.rm = TRUE),
"NE.EXP.GNFS.CD" = median(Data$NE.EXP.GNFS.CD,  na.rm = TRUE))
Mediland["Log_Agri"] <- log(Mediland$TX.VAL.AGRI.ZS.UN)
Mediland["Log_GDPperCap"] <- log(Mediland$NY.GDP.PCAP.CD)
Mediland["Log_Export"] <- log(Mediland$NE.EXP.GNFS.CD)
predict(model1 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_Export = Mediland$Log_Export))
predict(model1 , data.frame(Log_Agri = Mediland$Log_Agri, Log_GDPperCap = Mediland$Log_GDPperCap, Log_Export = Mediland$Log_Export))
